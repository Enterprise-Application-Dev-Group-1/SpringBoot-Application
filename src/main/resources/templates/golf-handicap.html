<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Golf Handicap Calculator</title>
    <link rel="stylesheet" href="/golf-handicap.css">
</head>

<body>
    <div class="container">
        <div class="nav-links">
            <a href="/golf-handicap">Home</a>
            <a href="/add-player">Add Player</a>
            <a href="/add-score">Add Score</a>
            <a href="/player-scores">View Player Scores</a>
        </div>

        <div class="weather-widget">
            <h3>‚õÖ Course Weather</h3>
            <p id="weather-info">Loading...</p>
            <button onclick="refreshWeather()">Refresh Weather</button>
        </div>

        <script>
            function updateWeather(latitude, longitude) {
                fetch(`/api/weather?lat=${latitude}&lon=${longitude}`)
                    .then(response => response.text())
                    .then(data => document.getElementById('weather-info').textContent = data)
                    .catch(() => document.getElementById('weather-info').textContent = 'Weather unavailable');
            }

            function refreshWeather() {
                if (navigator.geolocation) {
                    document.getElementById('weather-info').textContent = 'Getting location...';
                    navigator.geolocation.getCurrentPosition(
                        position => {
                            updateWeather(position.coords.latitude, position.coords.longitude);
                        },
                        error => {
                            document.getElementById('weather-info').textContent = 'Location access denied';
                        }
                    );
                } else {
                    document.getElementById('weather-info').textContent = 'Geolocation not supported';
                }
            }

            // Automatically load weather on page load
            refreshWeather();
        </script>

        <h1>üèåÔ∏è‚Äç‚ôÇÔ∏è Golf Handicap Calculator</h1>
        <form action="/calculate-handicap" method="post">
            <p class="description">Enter your last 10 outing scores and course pars below to estimate your handicap.</p>

            <div class="inputs-grid">
                <div class="input-column">
                    <h3>Scores</h3>
                    <div class="input-list">
                        <input type="number" name="scores" min="1" max="200" required>
                        <input type="number" name="scores" min="1" max="200" required>
                        <input type="number" name="scores" min="1" max="200" required>
                        <input type="number" name="scores" min="1" max="200" required>
                        <input type="number" name="scores" min="1" max="200" required>
                        <input type="number" name="scores" min="1" max="200" required>
                        <input type="number" name="scores" min="1" max="200" required>
                        <input type="number" name="scores" min="1" max="200" required>
                        <input type="number" name="scores" min="1" max="200" required>
                        <input type="number" name="scores" min="1" max="200" required>
                    </div>
                </div>
                <div class="input-column">
                    <h3>Course Pars</h3>
                    <div class="input-list">
                        <input type="number" name="pars" min="1" max="100" required>
                        <input type="number" name="pars" min="1" max="100" required>
                        <input type="number" name="pars" min="1" max="100" required>
                        <input type="number" name="pars" min="1" max="100" required>
                        <input type="number" name="pars" min="1" max="100" required>
                        <input type="number" name="pars" min="1" max="100" required>
                        <input type="number" name="pars" min="1" max="100" required>
                        <input type="number" name="pars" min="1" max="100" required>
                        <input type="number" name="pars" min="1" max="100" required>
                        <input type="number" name="pars" min="1" max="100" required>
                    </div>
                </div>
            </div>

            <button type="submit">Calculate Handicap</button>
        </form>

        <div class="result">
            <p th:if="${handicap != null}">
                Your calculated handicap: <span th:text="${handicap}"></span>
            </p>
        </div>
    </div>
</body>

</html>